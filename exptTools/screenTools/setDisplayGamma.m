function subGammaTable = setDisplayGamma(display)%subGammaTable = setDisplayGamma(display)%% NOTE: Do not use this routine for 10 bit graphics.  Should instead use% the tenBit2eightBit to generate the appropriate gamma table.  setDisplayGamma% now returns subGammaTable.  Eventually, this routine should only return the% the eight bit subGamma table (to work better with the current openScreen) and% should be renamed something like 'getEightBitGamma'.%%Sets the internal gamma table buffer using the following parameters:%display.gammaTable   1xdisplay.pixelDepth array holding gamma correction function.%display.midDac       integer value, mid (mean level) dac value%display.stepDac      integer value, step size for each lut value above and below%					  the midDac value%Defaults:%%                  %                    8 bit     |   10 bit%display.midDac       128      |     512%display.stepDac        1      |       4        %create a subGammaTable table by sampling display.gammaTablenDacs = 2^display.pixelDepth;minDac = display.midDac-display.numColors/2*display.stepDac+1;maxDac = display.midDac+display.numColors/2*display.stepDac - display.stepDac+1;id  = [minDac:display.stepDac:maxDac];if minDac<1	disp('Warning! display.midDac set too low for display.stepDac.');	disp(sprintf('ll colormap entries of %d or below will be set to black.',max(find(id<1))));	id = max(id,1);endif maxDac>nDacs	disp('Warning! display.midDac set too high for display.stepDac.');	disp(sprintf('ll colormap entries of %d or above will be set to white.',min(find(id>nDacs))));	id = min(id,nDacs);endmaxContrast = (max(id)-min(id))/(max(id)+min(id)-2);if maxContrast ~=1	disp(sprintf('Warning: maximum contrast is %3.2f',maxContrast));end%Old way, using display.maxIntensity and display.maxContrast%id = round(display.maxIntensity*(2^display.pixelDepth-1)*...%    (display.maxContrast*linspace(-1,1,display.numColors)+1)/2)+1;subGammaTable = display.gammaTable(id,:);%plot(subGammaTable)%hold on%plot(id,subGammaTable,'r.','MarkerSize',15);%hold off%zoomSCREEN(display.windowPtr,'Gamma',subGammaTable,display.pixelDepth)